<!-- Implicit Graph Search Library(C), 2009, 2010 -->

<project name="igsl" default="doc" basedir="..">
	<filelist id="src.files" dir="src" files="
		org/igsl/traversal/TreeTraversal.java,
		org/igsl/traversal/CostTreeTraversal.java,
		org/igsl/traversal/Copyable.java,
		org/igsl/traversal/CopyableTreeTraversal.java,
		org/igsl/traversal/CopyableCostTreeTraversal.java,
		org/igsl/traversal/linear/DepthFirstTreeTraversal.java,
		org/igsl/traversal/linear/DepthFirstCostTreeTraversal.java,
		org/igsl/traversal/linear/RecursiveBestFirstTreeTraversal.java,
		org/igsl/traversal/exponential/BestFirstCostTreeTraversal.java,
		org/igsl/traversal/exponential/AStarTreeTraversal.java,
		org/igsl/functor/NodeGenerator.java,
		org/igsl/functor/CostFunction.java,
		org/igsl/functor/HeuristicFunction.java,
		org/igsl/functor/Memoizer.java,
		org/igsl/cost/Addable.java,
		org/igsl/cost/AddableInteger.java,
		org/igsl/cost/AddableDouble.java,
		org/igsl/algorithm/Direct.java,
		org/igsl/algorithm/Iterative.java"
	/>
	
	<filelist id="app.files" dir="app" files="
		org/igsl/app/eightknights/Board.java,
		org/igsl/app/eightknights/EKPSolver.java,
		org/igsl/app/sudoku/Table.java,
		org/igsl/app/sudoku/SudokuSolver.java,
		org/igsl/app/tsp/Route.java,
		org/igsl/app/tsp/TSPSolver.java,
		org/igsl/app/fifteens/Position.java,
		org/igsl/app/fifteens/FifteensSolver.java"
	/>
	
	<target name="doc">
		<javadoc destdir="doc/javadoc">
			<sourcefiles>
				<filelist refid="src.files"/>
				<filelist refid="app.files"/>
			</sourcefiles>
		</javadoc>
	</target>
	
	<target name="make.jar">
		<mkdir dir="temp"/>
		<copy todir="temp">
			<filelist refid="src.files"/>
		</copy>
		
		<mkdir dir="bin"/>
		<javac 
			nowarn="on"
			listfiles="yes"
			fork="yes"
			srcdir="temp"
			destdir="bin"
			debug = "on"
		/>
		<delete dir="temp"/>

		<mkdir dir="lib"/>
		<jar basedir="bin" destfile="lib/igsl.jar"/>
		<delete dir="bin"/>
	</target>
	
	<target name="compile.test" depends="make.jar">
		<mkdir dir="temp"/>
		<copy todir="temp">
			<filelist refid="app.files"/>
		</copy>

		<mkdir dir="bin"/>
		<javac
			listfiles="yes"
			fork="yes"
			srcdir="temp"
			destdir="bin"
			classpath="lib/igsl.jar"
			debug = "on"
		/>
		<delete dir="temp"/>
	</target>
	
	<target name="run.test" depends="compile.test">
		<java fork="true" classname="org.igsl.app.eightknights.EKPSolver">
			<classpath>
				<pathelement path="bin"/>
				<pathelement location="lib/igsl.jar"/>
			</classpath>
		</java>
		<java fork="true" classname="org.igsl.app.sudoku.SudokuSolver">
			<classpath>
				<pathelement path="bin"/>
				<pathelement location="lib/igsl.jar"/>
			</classpath>
		</java>
		<java fork="true" classname="org.igsl.app.tsp.TSPSolver">
			<classpath>
				<pathelement path="bin"/>
				<pathelement location="lib/igsl.jar"/>
			</classpath>
		</java>
		<java fork="true" classname="org.igsl.app.fifteens.FifteensSolver">
			<classpath>
				<pathelement path="bin"/>
				<pathelement location="lib/igsl.jar"/>
			</classpath>
		</java>
		<delete dir="bin"/>
	</target>
	
	<target name="make.release" depends="compile.test,doc">
		<mkdir dir="release"/>
		<zip destfile="release/igsl-${os.arch}-win32.zip">
			<fileset dir="./doc"/>
			<fileset dir="." includes="lib/**"/>
			<fileset dir="." includes="bin/**"/>
			<fileset dir="." includes="app/**"/>
		</zip>
	</target>
	
	<target name="clean">
		<delete dir="bin"/>
		<delete dir="lib"/>
	</target>
	
	<target name="clean.javadoc">
		<delete dir="doc/javadoc"/>
	</target>
	
</project>